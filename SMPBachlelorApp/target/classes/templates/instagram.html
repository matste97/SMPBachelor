<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram</title>
    <link rel="stylesheet" type="text/css" th:href="@{/styles/instagram.css}">
    <script th:src="@{/js/Navigation.js}"></script>
    <script th:src="@{js/Instagram.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav th:replace="~{components/navigation}"></nav>
    <h1>INSTAGRAM</h1>
    <!-- Display the follower count -->
    <h2 th:if="${followersCount != null}" th:text="'Følgere: ' + ${followersCount}"></h2>
    <!-- Handle the case when follower count is not available -->
    <h2 th:if="${followersCount == null}">Follower count not available</h2>

    <h1>Seere i dag</h1>
     <!-- Add a canvas element for the chart -->
     <canvas id="insightsChart" class="chart"></canvas>

     <script th:inline="javascript">
         var insightsData = /*[[${insightsData}]]*/ [];
         createChart(insightsData);
     </script>

    <h1>Alder og kjønn av følgere</h1>

    <!-- Add a canvas element for the new chart -->
    <canvas id="ageAndGenderChart" class="chart"></canvas>

<script th:inline="javascript">
    var followersAgeAndGenderInsightsData = /*[[${followersAgeAndGenderInsights}]]*/ [];
    var ageAndGenderData = followersAgeAndGenderInsightsData[0].values[0].value;
    createAgeAndGenderChart(ageAndGenderData);
</script>

     <h1>Nylige innlegg</h1>
    
     <div class="grid-container" th:if="${latestPosts != null and latestPosts.size() > 0}">
        <div class="grid-item" th:each="post : ${latestPosts}">
            <!-- Display thumbnail -->
            <img class="thumbnail" th:if="${post.media_type == 'IMAGE'}" th:src="${post.media_url}" th:alt="${post.caption != null ? post.caption : 'Missing thumbnail'}"/> 
            <img class="thumbnail" th:if="${post.media_type == 'VIDEO'}" th:src="${post.thumbnail_url}" th:alt="${post.caption != null ? post.caption : 'Missing thumbnail'}"/> 
            <img class="thumbnail" th:if="${post.media_type == 'CAROUSEL_ALBUM'}" th:src="${post.media_url}" th:alt="${post.caption != null ? post.caption : 'Missing thumbnail'}"/> 
                
                <!-- Display caption, comment count, like count, and timestamp -->
                <div class="caption" th:if="${post.caption != null}" th:text="${post.caption}"></div>
                <div class="media-text">
                    <div>Kommentarer: <span th:text="${post.comments_count}"></span></div>
                    <div>Likes: <span th:text="${post.like_count}"></span></div>
                    <div th:text="${post.formattedTimestamp}"></div>
                </div>
            </div>
        </div>
    
    <!-- Display message if latest posts retrieval fails -->
    <div th:if="${latestPosts == null or latestPosts.size() == 0}">
        <p>Failed to retrieve latest posts.</p>
    </div>

</body>
</html>
